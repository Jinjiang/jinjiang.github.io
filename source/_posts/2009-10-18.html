---
title: "聊天室似乎没有想象中那么难做"
date: 2009/10/18 17:30
updated: 2009/10/18 17:30
---

<p><mark>本文摘自 勾三股四 更早时期的 <a href="http://bulaoge.net/?g3g4">不老歌</a> 博客。</mark></p>
<p>最近看到一个聊天室的例子：<a href="http://css-tricks.com/jquery-php-chat/" target="_blank">http://css-tricks.com/jquery-php-chat/</a><br />
<br />
与其说是一个聊天室的demo，不如说是借这个demo构建了一个聊天室的开发原型。<br />
<br />
一个聊天室要有通信机制，要有身份识别机制，要有数据存储机制，要有表现机制。这差不多就可以简要概括一个聊天室的构建：<br />
<br />
<strong>通信机制</strong><br />
需要Web的Ajax前台和Php后台协同工作，这里分为获取已有数据(这里是定时循环获取的)以及发送新数据(留言)这两点，额外还有一个页面初始化的操作(确定数据的起始点)。<br />
<br />
以上三部分分别对应源代码中的：<pre>updateChat()<br />sendChat(message, nickname)<br />getStateOfChat()</pre><br />
我们可以在这个模型之上，根据我们的需求进行扩展。比如可以筛选信息，管理历史记录等等。<br />
<br />
<strong>身份识别机制</strong><br />
这里的身份识别仅仅是要求用户在页面打开的时候输入一个昵称，作为身份的识别——已经简单到不能再简单了。<br />
我们可以在这个模型之上，加入账户的登录注销、密码保护、连带账户信息管理之类的内容。<br />
<br />
<strong>数据存储机制</strong><br />
这里通过txt文本文件记录聊天信息，每多一条记录，就在文件后面多写一行。真是简化的一塌糊涂……<br />
数据这边的扩展方式是多种多样、五花八门的。存储方式也应该因数据结构的不同而选择正确的存储方式，例如，文本文件可以像serverlog那样，定时或定量切割成小文件，以保证执行效率和管理成本；也可以采用数据库存储，便于历史记录的管理或多维数据关系的建立；数据结构本身可以由纯文本扩展为富文本，甚至二进制码。在此不做进一步展开讨论了<br />
<br />
<strong>表现机制</strong><br />
其实我们可以把这样的消息机制包装成各种通信服务，除了最简单的聊天室，像IM、短消息、在线广播，都可以做到。同时，除了Web Client，也可以通过exe执行程序等方式的客户端进行操作。<br />
<br />
以上是关于此聊天室demo程序的一些思考，突然觉得在软件开发中，原型设计很重要。呵呵<br />
有点后知后觉</p>
